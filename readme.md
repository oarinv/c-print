# 🖨️ printer_connect.exe - 局域网共享打印机自动连接工具

## 📌 项目简介

本程序自动扫描本地局域网中所有 `192.168.x.x` 网段内共享的打印机设备，连接第一个找到的打印机，并将其设置为默认打印机。
兼容 Windows 7 / 10 / 11 系统，支持 32 位环境，适合 IT 运维自动化部署。

## 🛠️ 编译方法（Windows 系统）

### ✅ 准备环境

建议安装以下任一 GCC 工具链（32 位）：

- [TDM-GCC 32 位](https://jmeubank.github.io/tdm-gcc/)
- 或使用 MSYS2 中的 `i686-w64-mingw32-gcc`

确保你在命令行中可以运行 `gcc` 命令。

### ✅ 编译命令

打开终端（CMD 或 PowerShell）进入项目目录，执行：

```bash
gcc.exe -m32 main.c -o printer_connect.exe -lws2_32 -liphlpapi -lnetapi32 -lwinspool
```

| 参数           | 说明                     |
| ------------ | ---------------------- |
| `-m32`       | 编译为 32 位可执行文件（兼容 Win7） |
| `-lws2_32`   | Winsock 网络库            |
| `-liphlpapi` | 获取本机网络接口信息库            |
| `-lnetapi32` | 枚举共享资源（使用 `net view`）  |
| `-lwinspool` | 打印机操作相关库               |


### 🚀 使用说明

1. 双击运行 `printer_connect.exe`。

2. 程序会自动执行以下操作：

   - 获取本机 IP 地址
   - 扫描 `192.168.X.X` 网段中的共享打印机
   - 自动连接第一个被发现的共享打印机
   - 设置该打印机为系统默认打印机

3. 若成功，终端中会显示如下信息：

```bash
成功设置 \\192.168.1.101\共享打印机名称 为默认打印机
按任意键退出...
```

4. 若未找到打印机或操作失败，将输出错误提示。

### 协议许可
本项目基于 MIT License 开源发布。